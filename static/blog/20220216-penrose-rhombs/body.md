![Penrose P3 tiling](static/blog/20220216-penrose-rhombs/penrose-I.png)

The Penrose P3 tiling is a tesselation of the plane by two types of rhombus:
'thin' rhombs, with interior angle $\pi / 5$, and 'thick' rhombs, with interior
angle $2 \pi /5$.

The P3 tiling can be generated by repeated subdivision:

![Thin rhomb subdivision](static/blog/20220216-penrose-rhombs/thin-rhomb-subdivision.png)
![Thick rhomb subdivision](static/blog/20220216-penrose-rhombs/thick-rhomb-subdivision.png)

The diagrams show half of each type of rhomb. Here $\phi$ is the golden ratio,
$\phi^2 = \phi + 1$. Subdivision is the operation

    [A B C] -> [D C A] + (C D B)
    (X Y Z) -> (U V X) + (Z U Y) + [V U Y]

where parentheses denote thick half-rhombs and brackets denote thin half-rhombs.

The following code generates the Penrose P3 tiling by repeated subdivision.

    import math
    import cmath
    import numpy as np
    import matplotlib.pyplot as plt

    ## Golden ratio
    g = (1 + math.sqrt(5)) / 2

    pa = np.exp(np.array([(k + 1) // 2 * 2 for k in range(10)]) * 1j * math.pi / 5)
    pb = np.array([complex(0, 0) for k in range(10)])
    pc = np.exp(np.array([1 + (k // 2 * 2) for k in range(10)]) * 1j * math.pi / 5)
    
    px = np.array([])
    py = np.array([])
    pz = np.array([])
        
    for k in range(5):
        pd = pa / g + pb * (1 - 1 / g)
        pu = pz / g + px * (1 - 1 / g)
        pv = py / g + px * (1 - 1 / g)

        ta = np.concatenate([pd, pv]) 
        tb = np.concatenate([pc, pu])
        tc = np.concatenate([pa, py])
    
        tx = np.concatenate([pu, pz, pc]) 
        ty = np.concatenate([pv, pu, pd])
        tz = np.concatenate([px, py, pb])
    
        pa, pb, pc, px, py, pz = ta, tb, tc, tx, ty, tz

    plt.figure(figsize=(10, 10))
    plt.gca().set_aspect('equal')
    plt.axis('off')
    
    for (x, y, z) in zip(px, py, pz):
        plt.plot([x.real, y.real, z.real], [x.imag, y.imag, z.imag], color='black')
        
    for (a, b, c) in zip(pa, pb, pc):
        plt.fill([a.real, b.real, c.real], [a.imag, b.imag, c.imag], color='black')
         
